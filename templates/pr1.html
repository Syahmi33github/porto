{% extends "base_project.html" %}
<!-- ssa -->
{% load static %}
<!-- sss -->

{% block navigation %}
<li><a href="#project-overview">Project Overview</a></li>
<li><a href="#import-data--module">Import Data Module</a></li>
<li><a href="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
<li><a href="#data-pre-processing">Data Pre-Processing</a></li>
<li><a href="#modelling">Model Machine Learning</a></li>
<li><a href="#evaluation">Evaluation</a></li>
{% endblock navigation %}

<!--  -->
{% block contents %}
<section
  id="brain-tumor-detection-with-resnet--efficientnet-model"
  class="cell-markdown"
  id="8oyI74xEo3-C"
>
  <h1>Brain Tumor Detection with Resnet &amp; Efficientnet Model</h1>
</section>
<a href="https://www.linkedin.com/in/syahmi-sajid-907544243/">
  <div class="card-container">
    <div class="card cell-code">
      <img src="{% static 'img\sya.jpg' %}" alt="Gambar 1" />
      <div class="contentcard">
        <p>Aut : Syahmi Sajid</p>
      </div>
    </div>
  </div>
</a>
<img
  class="img-title"
  src="{% static 'img\tumor\klasifikasitumorotak.jpg' %}"
  class="img-responsive rounded"
  alt="Download free bootstrap 4 landing page, free boootstrap 4 templates, Download free bootstrap 4.1 landing page, free boootstrap 4.1.1 templates, meyawo Landing page"
/>
<section id="project-overview" class="cell-markdown" id="cDip45PXpQgj">
  <h2>Project Overview</h2>
</section>
<div class="cell-markdown" id="mYwfcSq-lCu5">
  <p>
    Proyek ini bertujuan untuk mengembangkan sistem deteksi tumor otak
    menggunakan model deep learning, khususnya ResNet dan EfficientNet. Sistem
    ini menggunakan jaringan saraf konvolusional (CNN) untuk mengklasifikasikan
    gambar MRI otak sebagai positif tumor atau negatif tumor. Data gambar MRI
    otak dikumpulkan, diproses, dan digunakan untuk melatih model-model CNN
    tersebut. Tujuannya adalah memilih Model terbaik untuk dipilih dan
    diimplementasikan sebagai sistem deteksi tumor otak untuk membantu dalam
    deteksi dini dan perawatan yang tepat.
  </p>
</div>
<div class="cell-markdown" id="XdhkLnErpjB4">
  <p>
    Data citra yang digunakan untuk permasalahan ini adalah Citra MRI Otak untuk
    Deteksi Tumor Otak. Ini berisi pemindaian MRI dari dua kelas:
  </p>
  <ul>
    <li>NO - no tumor, encoded as 0</li>
    <li>YES - tumor, encoded as 1</li>
  </ul>
  <p>
    Sayangnya, deskripsi kumpulan data tidak menyimpan informasi apa pun dari
    mana pemindaian MRI ini berasal.
  </p>
</div>
<section id="apa-itu-tumor-otak" class="cell-markdown" id="UswMLCbRp-so">
  <h2>Apa itu Tumor Otak?</h2>
</section>
<div class="cell-markdown" id="VFfonuN3qDWO">
  <p>
    Tumor otak terjadi ketika sel-sel abnormal terbentuk di dalam otak. Ada dua
    jenis utama tumor: tumor kanker (ganas) dan tumor jinak. Tumor kanker dapat
    dibagi menjadi tumor primer, yang dimulai di dalam otak, dan tumor sekunder,
    yang telah menyebar dari tempat lain, yang dikenal sebagai tumor metastasis
    otak. Semua jenis tumor otak dapat menimbulkan gejala yang bervariasi
    tergantung pada bagian otak yang terkena. Gejala-gejala ini mungkin termasuk
    sakit kepala, kejang, masalah penglihatan, muntah, dan perubahan mental.
    Sakit kepala biasanya lebih buruk di pagi hari dan hilang dengan muntah.
    Gejala lain mungkin termasuk kesulitan berjalan, berbicara atau dengan
    sensasi. Seiring perkembangan penyakit, ketidaksadaran dapat terjadi.
  </p>
</div>
<div class="cell-markdown" id="A6XulGKrqVES">
  <p>
    <img
      src="{% static 'img\tumor_new\5617ce8f041c41f6ca27ce4d9d76b5ad2d3e7b68.png' %}"
      alt="image.png"
    />
  </p>
</div>
<section id="import-data--module" class="cell-markdown" id="MxQ0f8_NpaY3">
  <h2>IMPORT DATA &amp; MODULE</h2>
</section>
<section
  id="load-data-menggunakan-api-kaggle"
  class="cell-markdown"
  id="z9zuU-PFlzC6"
>
  <h3>Load data menggunakan API KAGGLE</h3>
</section>
<div
  class="cell-code"
  data-execution_count="1"
  data-colab='{"base_uri":"https://localhost:8080/","height":88}'
  id="ZMKzsrmekOKf"
  data-outputId="9f58da11-e2a7-4892-aad8-111984c644c1"
>
  <div class="sourceCode" id="cb1">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C:\Users\USER\.kaggle</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> files</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>files.upload()</span></code></pre>
  </div>
  <div class="output display_data">
    <input
      type="file"
      id="files-0d5a520b-b113-4181-b88a-5910d2e73e80"
      name="files[]"
      multiple
      disabled
      style="border: none"
    />
    <output id="result-0d5a520b-b113-4181-b88a-5910d2e73e80">
      Upload widget is only available when the cell has been executed in the
      current browser session. Please rerun this cell to enable.
    </output>
    <script>
      // Copyright 2017 Google LLC
      //
      // Licensed under the Apache License, Version 2.0 (the "License");
      // you may not use this file except in compliance with the License.
      // You may obtain a copy of the License at
      //
      //      http://www.apache.org/licenses/LICENSE-2.0
      //
      // Unless required by applicable law or agreed to in writing, software
      // distributed under the License is distributed on an "AS IS" BASIS,
      // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      // See the License for the specific language governing permissions and
      // limitations under the License.

      /**
       * @fileoverview Helpers for google.colab Python module.
       */
      (function (scope) {
        function span(text, styleAttributes = {}) {
          const element = document.createElement("span");
          element.textContent = text;
          for (const key of Object.keys(styleAttributes)) {
            element.style[key] = styleAttributes[key];
          }
          return element;
        }

        // Max number of bytes which will be uploaded at a time.
        const MAX_PAYLOAD_SIZE = 100 * 1024;

        function _uploadFiles(inputId, outputId) {
          const steps = uploadFilesStep(inputId, outputId);
          const outputElement = document.getElementById(outputId);
          // Cache steps on the outputElement to make it available for the next call
          // to uploadFilesContinue from Python.
          outputElement.steps = steps;

          return _uploadFilesContinue(outputId);
        }

        // This is roughly an async generator (not supported in the browser yet),
        // where there are multiple asynchronous steps and the Python side is going
        // to poll for completion of each step.
        // This uses a Promise to block the python side on completion of each step,
        // then passes the result of the previous step as the input to the next step.
        function _uploadFilesContinue(outputId) {
          const outputElement = document.getElementById(outputId);
          const steps = outputElement.steps;

          const next = steps.next(outputElement.lastPromiseValue);
          return Promise.resolve(next.value.promise).then((value) => {
            // Cache the last promise value to make it available to the next
            // step of the generator.
            outputElement.lastPromiseValue = value;
            return next.value.response;
          });
        }

        /**
         * Generator function which is called between each async step of the upload
         * process.
         * @param {string} inputId Element ID of the input file picker element.
         * @param {string} outputId Element ID of the output display.
         * @return {!Iterable<!Object>} Iterable of next steps.
         */
        function* uploadFilesStep(inputId, outputId) {
          const inputElement = document.getElementById(inputId);
          inputElement.disabled = false;

          const outputElement = document.getElementById(outputId);
          outputElement.innerHTML = "";

          const pickedPromise = new Promise((resolve) => {
            inputElement.addEventListener("change", (e) => {
              resolve(e.target.files);
            });
          });

          const cancel = document.createElement("button");
          inputElement.parentElement.appendChild(cancel);
          cancel.textContent = "Cancel upload";
          const cancelPromise = new Promise((resolve) => {
            cancel.onclick = () => {
              resolve(null);
            };
          });

          // Wait for the user to pick the files.
          const files = yield {
            promise: Promise.race([pickedPromise, cancelPromise]),
            response: {
              action: "starting",
            },
          };

          cancel.remove();

          // Disable the input element since further picks are not allowed.
          inputElement.disabled = true;

          if (!files) {
            return {
              response: {
                action: "complete",
              },
            };
          }

          for (const file of files) {
            const li = document.createElement("li");
            li.append(span(file.name, { fontWeight: "bold" }));
            li.append(
              span(
                `(${file.type || "n/a"}) - ${file.size} bytes, ` +
                  `last modified: ${
                    file.lastModifiedDate
                      ? file.lastModifiedDate.toLocaleDateString()
                      : "n/a"
                  } - `
              )
            );
            const percent = span("0% done");
            li.appendChild(percent);

            outputElement.appendChild(li);

            const fileDataPromise = new Promise((resolve) => {
              const reader = new FileReader();
              reader.onload = (e) => {
                resolve(e.target.result);
              };
              reader.readAsArrayBuffer(file);
            });
            // Wait for the data to be ready.
            let fileData = yield {
              promise: fileDataPromise,
              response: {
                action: "continue",
              },
            };

            // Use a chunked sending to avoid message size limits. See b/62115660.
            let position = 0;
            do {
              const length = Math.min(
                fileData.byteLength - position,
                MAX_PAYLOAD_SIZE
              );
              const chunk = new Uint8Array(fileData, position, length);
              position += length;

              const base64 = btoa(String.fromCharCode.apply(null, chunk));
              yield {
                response: {
                  action: "append",
                  file: file.name,
                  data: base64,
                },
              };

              let percentDone =
                fileData.byteLength === 0
                  ? 100
                  : Math.round((position / fileData.byteLength) * 100);
              percent.textContent = `${percentDone}% done`;
            } while (position < fileData.byteLength);
          }

          // All done.
          yield {
            response: {
              action: "complete",
            },
          };
        }

        scope.google = scope.google || {};
        scope.google.colab = scope.google.colab || {};
        scope.google.colab._files = {
          _uploadFiles,
          _uploadFilesContinue,
        };
      })(self);
    </script>
  </div>
  <div class="output stream stdout">
    <pre><code>Saving kaggle.json to kaggle.json
</code></pre>
  </div>
  <div class="output execute_result" data-execution_count="1">
    <pre><code>{&#39;kaggle.json&#39;: b&#39;{&quot;username&quot;:&quot;*********************&quot;,&quot;key&quot;:&quot;*********************&quot;}&#39;}</code></pre>
  </div>
</div>
<div class="cell-code" data-execution_count="2" id="G0aJM9UpkdsS">
  <div class="sourceCode" id="cb4">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>mkdir <span class="op">~/</span>.kaggle</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cp kaggle.json <span class="op">~/</span>.kaggle<span class="op">/</span></span></code></pre>
  </div>
</div>
<section id="load-data-dari-kaggle" class="cell-markdown" id="jJa347Fdl0aJ">
  <h4>Load Data dari Kaggle</h4>
</section>
<div
  class="cell-code"
  data-execution_count="3"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="EPWpItewkgGO"
  data-outputId="15c48928-34cb-48d7-9d65-34b3f1e05792"
>
  <div class="sourceCode" id="cb5">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle datasets download <span class="op">-</span>d navoneel<span class="op">/</span>brain<span class="op">-</span>mri<span class="op">-</span>images<span class="op">-</span><span class="cf">for</span><span class="op">-</span>brain<span class="op">-</span>tumor<span class="op">-</span>detection</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Warning: Your Kaggle API key is readable by other users on this system! To fix this, you can run &#39;chmod 600 /root/.kaggle/kaggle.json&#39;
Downloading brain-mri-images-for-brain-tumor-detection.zip to /content
 79% 12.0M/15.1M [00:00&lt;00:00, 38.3MB/s]
100% 15.1M/15.1M [00:00&lt;00:00, 44.2MB/s]
</code></pre>
  </div>
</div>
<section id="import-module" class="cell-markdown" id="VHSpJgR1Wkng">
  <h4>Import Module</h4>
</section>
<div class="cell-code" data-execution_count="5" id="SXf3mJc37LvO">
  <div class="sourceCode" id="cb7">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre>
  </div>
</div>
<section id="import-function" class="cell-markdown" id="ApG_MroTl-dw">
  <h4>Import Function</h4>
</section>
<div
  class="cell-code"
  data-execution_count="4"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="Im6-cS18knyE"
  data-outputId="0fe93134-5ccb-45e9-c460-495c048c0c70"
>
  <div class="sourceCode" id="cb8">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get helper_functions.py script from course GitHub</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget https:<span class="op">//</span>raw.githubusercontent.com<span class="op">/</span>Syahmi33github<span class="op">/</span>Emotion<span class="op">-</span>Classification<span class="op">/</span>main<span class="op">/</span>helper_functions.py</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Import helper functions we&#39;re going to use</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> helper_functions <span class="im">import</span> create_tensorboard_callback, plot_loss_curves, unzip_data, walk_through_dir, view_random_images,pred_and_plot, load_and_prep_image</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>--2023-07-02 07:51:22--  https://raw.githubusercontent.com/Syahmi33github/Emotion-Classification/main/helper_functions.py
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.111.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 11485 (11K) [text/plain]
Saving to: ‘helper_functions.py’


helper_functions.py   0%[                    ]       0  --.-KB/s               
helper_functions.py 100%[===================&gt;]  11.22K  --.-KB/s    in 0s      

2023-07-02 07:51:22 (66.5 MB/s) - ‘helper_functions.py’ saved [11485/11485]

</code></pre>
  </div>
</div>
<section id="exploratory-data-analysis" class="cell-markdown" id="09m9TlgpmFU3">
  <h2>EXPLORATORY DATA ANALYSIS</h2>
</section>
<div class="cell-code" data-execution_count="6" id="CquP30-yksXp">
  <div class="sourceCode" id="cb10">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>unzip_data(<span class="st">&quot;/content/brain-mri-images-for-brain-tumor-detection.zip&quot;</span>)</span></code></pre>
  </div>
</div>
<section
  id="proportion-of-number-of-each-class"
  class="cell-markdown"
  id="6uylXGXjwBUv"
>
  <h3>Proportion of Number of Each Class</h3>
</section>
<div
  class="cell-code"
  data-execution_count="35"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="zzHBdY01kwmF"
  data-outputId="c16e5d61-7b59-4564-8f58-1b93c9a126b5"
>
  <div class="sourceCode" id="cb11">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>walk_through_dir(<span class="st">&quot;/content/brain_tumor_dataset&quot;</span>)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>There are 2 directories and 0 images in &#39;/content/brain_tumor_dataset&#39;.
There are 0 directories and 155 images in &#39;/content/brain_tumor_dataset/yes&#39;.
There are 0 directories and 98 images in &#39;/content/brain_tumor_dataset/no&#39;.
</code></pre>
  </div>
</div>
<div class="cell-code" data-execution_count="38" id="TMIBMb0quohy">
  <div class="sourceCode" id="cb13">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_images_in_folder(folder_path):</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    image_extensions <span class="op">=</span> [<span class="st">&#39;.jpg&#39;</span>, <span class="st">&#39;.jpeg&#39;</span>, <span class="st">&#39;.png&#39;</span>, <span class="st">&#39;.gif&#39;</span>]  <span class="co"># Ekstensi file gambar yang akan dihitung</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> file_name <span class="kw">in</span> os.listdir(folder_path):</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">any</span>(ext <span class="kw">in</span> file_name.lower() <span class="cf">for</span> ext <span class="kw">in</span> image_extensions):</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>            file_path <span class="op">=</span> os.path.join(folder_path, file_name)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                Image.<span class="bu">open</span>(file_path)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>                count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span>  <span class="co"># Skip file yang tidak dapat dibuka sebagai gambar</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span></code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="36"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="_RxHG-NqnmJq"
  data-outputId="18fbc28c-7f89-4c71-8b6b-ac447ac0b797"
>
  <div class="sourceCode" id="cb14">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>no_path <span class="op">=</span> <span class="st">&quot;/content/no&quot;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>yes_path <span class="op">=</span> <span class="st">&quot;/content/yes&quot;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> [no_path, yes_path]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Jumlah_data <span class="op">=</span> []</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> path:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  count <span class="op">=</span> count_images_in_folder(x)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  Jumlah_data.append(count)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>Jumlah_data</span></code></pre>
  </div>
  <div class="output execute_result" data-execution_count="36">
    <pre><code>[98, 155]</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="37"
  data-colab='{"base_uri":"https://localhost:8080/","height":1000}'
  id="7LuvVv6CoYCj"
  data-outputId="1a7655ea-9a38-4bf3-9bb5-d501a1496e26"
>
  <div class="sourceCode" id="cb16">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> [<span class="st">&quot;Data No&quot;</span>, <span class="st">&quot;Data Yes&quot;</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat plot menggunakan seaborn</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">&quot;whitegrid&quot;</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>label, y<span class="op">=</span>Jumlah_data)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Jumlah Data Keseluruhan Data&#39;</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Label&#39;</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Jumlah Data&#39;</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Menambahkan keterangan nilai akurasi pada setiap batang</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Jumlah_data)):</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    plt.text(i, Jumlah_data[i] <span class="op">+</span> <span class="fl">0.01</span>, <span class="bu">str</span>(Jumlah_data[i]), ha<span class="op">=</span><span class="st">&#39;center&#39;</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>plt.pie(Jumlah_data, labels<span class="op">=</span>label, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        colors<span class="op">=</span>sns.color_palette(<span class="st">&#39;viridis&#39;</span>), startangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Work Year Distribution&#39;</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\0def01a56b18c69b3bccd3ea93fa9336bd27b95f.png' %}"
      />
    </p>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\28e3a95d3cb900690947ac19f78eb8747140c1f6.png' %}"
      />
    </p>
  </div>
</div>
<div class="cell-markdown" id="UePQR5fFtyM6">
  <p>Distribusi Data cukup seimbang 40% 60%</p>
</div>
<section id="visualization-image-data" class="cell-markdown" id="1wYpGCuimdsM">
  <h3>Visualization Image Data</h3>
</section>
<div class="cell-code" data-execution_count="20" id="XgdS7tS6oOQD">
  <div class="sourceCode" id="cb17">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>train_dir <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_dataset/&#39;</span></span></code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="21"
  data-colab='{"base_uri":"https://localhost:8080/","height":620}'
  id="b1sQAMgYlHm4"
  data-outputId="8edd6188-0f79-4054-bc65-40edeb595a6a"
>
  <div class="sourceCode" id="cb18">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View a random image from the training dataset</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> view_random_images(target_dir<span class="op">=</span>train_dir,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                        target_class<span class="op">=</span><span class="st">&quot;no&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                        num_images <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View a random image from the training dataset</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> view_random_images(target_dir<span class="op">=</span>train_dir,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                        target_class<span class="op">=</span><span class="st">&quot;yes&quot;</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                        num_images <span class="op">=</span> <span class="dv">8</span>)</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\36db00124eff830522c4b82141242fe191098b98.png' %}"
      />
    </p>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\8e443a6fc541c3eef1ef0f09a6124fb89687ce51.png' %}"
      />
    </p>
  </div>
</div>
<section id="data-pre-processing" class="cell-markdown" id="zFU2PIr-hCHS">
  <h2>Data Pre Processing</h2>
</section>
<section id="crop-image" class="cell-markdown" id="X06cgHr-q5Dr">
  <h3>Crop Image</h3>
</section>
<div class="cell-code" data-execution_count="23" id="dBmTmpB5sYAG">
  <div class="sourceCode" id="cb19">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> crop_img(img, add_pixels_value<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Finds the extreme points on the image and crops the rectangular out of them</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    gray <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    gray <span class="op">=</span> cv2.GaussianBlur(gray, (<span class="dv">5</span>, <span class="dv">5</span>), <span class="dv">0</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># threshold the image, then perform a series of erosions +</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dilations to remove any small regions of noise</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> cv2.threshold(gray, <span class="dv">45</span>, <span class="dv">255</span>, cv2.THRESH_BINARY)[<span class="dv">1</span>]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> cv2.erode(thresh, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> cv2.dilate(thresh, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find contours in thresholded image, then grab the largest one</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    cnts, _ <span class="op">=</span> cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="bu">max</span>(cnts, key<span class="op">=</span>cv2.contourArea)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find the extreme points</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    extLeft <span class="op">=</span> <span class="bu">tuple</span>(c[c[:, :, <span class="dv">0</span>].argmin()][<span class="dv">0</span>])</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    extRight <span class="op">=</span> <span class="bu">tuple</span>(c[c[:, :, <span class="dv">0</span>].argmax()][<span class="dv">0</span>])</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    extTop <span class="op">=</span> <span class="bu">tuple</span>(c[c[:, :, <span class="dv">1</span>].argmin()][<span class="dv">0</span>])</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    extBot <span class="op">=</span> <span class="bu">tuple</span>(c[c[:, :, <span class="dv">1</span>].argmax()][<span class="dv">0</span>])</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    ADD_PIXELS <span class="op">=</span> add_pixels_value</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    new_img <span class="op">=</span> img[extTop[<span class="dv">1</span>]<span class="op">-</span>ADD_PIXELS:extBot[<span class="dv">1</span>]<span class="op">+</span>ADD_PIXELS, extLeft[<span class="dv">0</span>]<span class="op">-</span>ADD_PIXELS:extRight[<span class="dv">0</span>]<span class="op">+</span>ADD_PIXELS].copy()</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [new_img]</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> crop_imgs_in_folder(original_folder, target_folder, add_pixels_value<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="co">    Finds the extreme points on the images in the original folder and crops the rectangular out of them,</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="co">    then saves the cropped images in the target folder.</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Membuat folder target jika belum ada</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.exists(target_folder):</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        os.makedirs(target_folder)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mendapatkan daftar file dalam folder asli</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    files <span class="op">=</span> os.listdir(original_folder)</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Mengabaikan file yang bukan gambar</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">file</span>.lower().endswith((<span class="st">&#39;.png&#39;</span>, <span class="st">&#39;.jpg&#39;</span>, <span class="st">&#39;.jpeg&#39;</span>)):</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Baca gambar</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>        img_path <span class="op">=</span> os.path.join(original_folder, <span class="bu">file</span>)</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>        img <span class="op">=</span> cv2.imread(img_path)</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Proses cropping gambar</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>        cropped_imgs <span class="op">=</span> crop_img(img, add_pixels_value)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Simpan hasil cropping</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, cropped_img <span class="kw">in</span> <span class="bu">enumerate</span>(cropped_imgs):</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>            new_file <span class="op">=</span> os.path.splitext(<span class="bu">file</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">&#39;_cropped_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i) <span class="op">+</span> os.path.splitext(<span class="bu">file</span>)[<span class="dv">1</span>]</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>            new_img_path <span class="op">=</span> os.path.join(target_folder, new_file)</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>            cv2.imwrite(new_img_path, cropped_img)</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Proses cropping selesai.&quot;</span>)</span></code></pre>
  </div>
</div>
<div class="cell-code" data-execution_count="24" id="PyTNw1Tq0Sbp">
  <div class="sourceCode" id="cb20">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> imutils</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> cv2.imread(<span class="st">&#39;/content/brain_tumor_dataset/no/20 no.jpg&#39;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> cv2.resize(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>            img,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            dsize<span class="op">=</span>(<span class="dv">224</span>,<span class="dv">224</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            interpolation<span class="op">=</span>cv2.INTER_CUBIC</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>gray <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>gray <span class="op">=</span> cv2.GaussianBlur(gray, (<span class="dv">5</span>, <span class="dv">5</span>), <span class="dv">0</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold the image, then perform a series of erosions +</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># dilations to remove any small regions of noise</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>thresh <span class="op">=</span> cv2.threshold(gray, <span class="dv">45</span>, <span class="dv">255</span>, cv2.THRESH_BINARY)[<span class="dv">1</span>]</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>thresh <span class="op">=</span> cv2.erode(thresh, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>thresh <span class="op">=</span> cv2.dilate(thresh, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># find contours in thresholded image, then grab the largest one</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>cnts <span class="op">=</span> cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>cnts <span class="op">=</span> imutils.grab_contours(cnts)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="bu">max</span>(cnts, key<span class="op">=</span>cv2.contourArea)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># find the extreme points</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>extLeft <span class="op">=</span> <span class="bu">tuple</span>(c[c[:, :, <span class="dv">0</span>].argmin()][<span class="dv">0</span>])</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>extRight <span class="op">=</span> <span class="bu">tuple</span>(c[c[:, :, <span class="dv">0</span>].argmax()][<span class="dv">0</span>])</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>extTop <span class="op">=</span> <span class="bu">tuple</span>(c[c[:, :, <span class="dv">1</span>].argmin()][<span class="dv">0</span>])</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>extBot <span class="op">=</span> <span class="bu">tuple</span>(c[c[:, :, <span class="dv">1</span>].argmax()][<span class="dv">0</span>])</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="co"># add contour on the image</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>img_cnt <span class="op">=</span> cv2.drawContours(img.copy(), [c], <span class="op">-</span><span class="dv">1</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">255</span>), <span class="dv">4</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="co"># add extreme points</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>img_pnt <span class="op">=</span> cv2.circle(img_cnt.copy(), extLeft, <span class="dv">8</span>, (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>), <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>img_pnt <span class="op">=</span> cv2.circle(img_pnt, extRight, <span class="dv">8</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>img_pnt <span class="op">=</span> cv2.circle(img_pnt, extTop, <span class="dv">8</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>img_pnt <span class="op">=</span> cv2.circle(img_pnt, extBot, <span class="dv">8</span>, (<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="co"># crop</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>ADD_PIXELS <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>new_img <span class="op">=</span> img[extTop[<span class="dv">1</span>]<span class="op">-</span>ADD_PIXELS:extBot[<span class="dv">1</span>]<span class="op">+</span>ADD_PIXELS, extLeft[<span class="dv">0</span>]<span class="op">-</span>ADD_PIXELS:extRight[<span class="dv">0</span>]<span class="op">+</span>ADD_PIXELS].copy()</span></code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="25"
  data-colab='{"base_uri":"https://localhost:8080/","height":321}'
  id="Y-C13P1H0Mta"
  data-outputId="be729242-e530-4e26-f17f-237ab031e55d"
>
  <div class="sourceCode" id="cb21">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">6</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">141</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.yticks([])</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Step 1. Get the original image&#39;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">142</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>plt.imshow(img_cnt)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>plt.yticks([])</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Step 2. Find the biggest contour&#39;</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">143</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>plt.imshow(img_pnt)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>plt.yticks([])</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Step 3. Find the extreme points&#39;</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">144</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>plt.imshow(new_img)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>plt.yticks([])</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Step 4. Crop the image&#39;</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\ec80ac61c89bdd70f8f1dd301abddbd1afa0d366.png' %}"
      />
    </p>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="26"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="PmnqY-tHy0xd"
  data-outputId="948c3b89-67c0-4391-ac3a-390538974398"
>
  <div class="sourceCode" id="cb22">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Path ke folder yang ingin Anda buat</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>folder_path <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_crop&#39;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>folder_path_no <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_crop/no&#39;</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>folder_path_yes <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_crop/yes&#39;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat folder</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>os.makedirs(folder_path, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>os.makedirs(folder_path_no, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>os.makedirs(folder_path_yes, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Folder berhasil dibuat!&quot;</span>)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Folder berhasil dibuat!
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="27"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="NXfKbN1DuJh3"
  data-outputId="44595d3c-5d60-4d86-82f5-e9067f06c144"
>
  <div class="sourceCode" id="cb24">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>original_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_dataset/no/&#39;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>target_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_crop/no/&#39;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>add_pixels_value <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>crop_imgs_in_folder(original_folder, target_folder)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Proses cropping selesai.
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="28"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="CUCGkwd-z4GS"
  data-outputId="baa646e5-4d77-44d2-875f-66e0b51d5e07"
>
  <div class="sourceCode" id="cb26">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>original_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_dataset/yes/&#39;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>target_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_crop/yes/&#39;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>add_pixels_value <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>crop_imgs_in_folder(original_folder, target_folder)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Proses cropping selesai.
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="29"
  data-colab='{"base_uri":"https://localhost:8080/","height":321}'
  id="lz6GG-epsngn"
  data-outputId="b3300244-f0be-4de0-fa27-41ccaea7b2e3"
>
  <div class="sourceCode" id="cb28">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View a random crop_image from the training dataset</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> view_random_images(target_dir<span class="op">=</span><span class="st">&#39;/content/brain_tumor_crop/&#39;</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                        target_class<span class="op">=</span><span class="st">&quot;no&quot;</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                        num_images <span class="op">=</span> <span class="dv">8</span>)</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\eda69653be6240973880fe0fa6b51c29a80767e2.png' %}"
      />
    </p>
  </div>
</div>
<section id="split-data" class="cell-markdown" id="UO2l-68qeIaJ">
  <h3>SPLIT DATA</h3>
</section>
<div
  class="cell-code"
  data-execution_count="31"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="JD2w0ic7fKFH"
  data-outputId="15bb5f52-d2ae-4164-83c4-905e1249b091"
>
  <div class="sourceCode" id="cb29">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Path ke folder yang ingin Anda buat</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>folder_path <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_split&#39;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat folder</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>os.makedirs(folder_path, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Folder berhasil dibuat!&quot;</span>)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Folder berhasil dibuat!
</code></pre>
  </div>
</div>
<section id="data-no" class="cell-markdown" id="Pg39YnSsf4NR">
  <h4>DATA NO</h4>
</section>
<div
  class="cell-code"
  data-execution_count="32"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="1p_zFrLieHAR"
  data-outputId="4aa72e59-fa19-4de3-be2e-5a5c576a401f"
>
  <div class="sourceCode" id="cb31">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Path ke folder data</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>data_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_crop/no&#39;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>train_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_split/train_data/no&#39;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>test_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_split/test_data/no&#39;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>validation_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_split/validation_data/no&#39;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pembagian persentase (train, test, validation)</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>train_percentage <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>test_percentage <span class="op">=</span> <span class="fl">0.03</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>validation_percentage <span class="op">=</span> <span class="fl">0.17</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat folder untuk set data</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>os.makedirs(train_folder, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>os.makedirs(test_folder, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>os.makedirs(validation_folder, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengambil daftar file dalam folder data</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>file_list <span class="op">=</span> os.listdir(data_folder)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengacak urutan file</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>random.shuffle(file_list)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghitung jumlah file untuk masing-masing set data</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>total_files <span class="op">=</span> <span class="bu">len</span>(file_list)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>train_size <span class="op">=</span> <span class="bu">int</span>(total_files <span class="op">*</span> train_percentage)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>test_size <span class="op">=</span> <span class="bu">int</span>(total_files <span class="op">*</span> test_percentage)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>validation_size <span class="op">=</span> total_files <span class="op">-</span> train_size <span class="op">-</span> test_size</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Memindahkan file ke set data masing-masing</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, file_name <span class="kw">in</span> <span class="bu">enumerate</span>(file_list):</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    file_path <span class="op">=</span> os.path.join(data_folder, file_name)</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> train_size:</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>        destination_folder <span class="op">=</span> train_folder</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> i <span class="op">&lt;</span> train_size <span class="op">+</span> test_size:</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>        destination_folder <span class="op">=</span> test_folder</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>        destination_folder <span class="op">=</span> validation_folder</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    shutil.copy(file_path, destination_folder)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Pembagian data selesai!&quot;</span>)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;train = </span><span class="sc">{</span>train_size<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;test = </span><span class="sc">{</span>test_size<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;validation = </span><span class="sc">{</span>validation_size<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Pembagian data selesai!
train = 68
test = 2
validation = 28
</code></pre>
  </div>
</div>
<section id="data-yes" class="cell-markdown" id="zlLE_00jf9Mo">
  <h4>DATA YES</h4>
</section>
<div
  class="cell-code"
  data-execution_count="33"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="EKrYN8rIf8hB"
  data-outputId="d83993c7-095b-46f6-c04b-20c9e5e2c00f"
>
  <div class="sourceCode" id="cb33">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Path ke folder data</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>data_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_crop/yes&#39;</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>train_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_split/train_data/yes&#39;</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>test_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_split/test_data/yes&#39;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>validation_folder <span class="op">=</span> <span class="st">&#39;/content/brain_tumor_split/validation_data/yes&#39;</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Pembagian persentase (train, test, validation)</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>train_percentage <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>test_percentage <span class="op">=</span> <span class="fl">0.03</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>validation_percentage <span class="op">=</span> <span class="fl">0.17</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat folder untuk set data</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>os.makedirs(train_folder, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>os.makedirs(test_folder, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>os.makedirs(validation_folder, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengambil daftar file dalam folder data</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>file_list <span class="op">=</span> os.listdir(data_folder)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengacak urutan file</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>random.shuffle(file_list)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghitung jumlah file untuk masing-masing set data</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>total_files <span class="op">=</span> <span class="bu">len</span>(file_list)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>train_size <span class="op">=</span> <span class="bu">int</span>(total_files <span class="op">*</span> train_percentage)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>test_size <span class="op">=</span> <span class="bu">int</span>(total_files <span class="op">*</span> test_percentage)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>validation_size <span class="op">=</span> total_files <span class="op">-</span> train_size <span class="op">-</span> test_size</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Memindahkan file ke set data masing-masing</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, file_name <span class="kw">in</span> <span class="bu">enumerate</span>(file_list):</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    file_path <span class="op">=</span> os.path.join(data_folder, file_name)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> train_size:</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>        destination_folder <span class="op">=</span> train_folder</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> i <span class="op">&lt;</span> train_size <span class="op">+</span> test_size:</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>        destination_folder <span class="op">=</span> test_folder</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>        destination_folder <span class="op">=</span> validation_folder</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    shutil.copy(file_path, destination_folder)</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Pembagian data selesai!&quot;</span>)</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;train = </span><span class="sc">{</span>train_size<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;test = </span><span class="sc">{</span>test_size<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;validation = </span><span class="sc">{</span>validation_size<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Pembagian data selesai!
train = 124
test = 4
validation = 27
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="34"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="dsa1oPw-gMqF"
  data-outputId="8fb48398-14c3-44f8-ba60-0e70d705cf65"
>
  <div class="sourceCode" id="cb35">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>walk_through_dir(<span class="st">&quot;/content/brain_tumor_split&quot;</span>)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>There are 3 directories and 0 images in &#39;/content/brain_tumor_split&#39;.
There are 2 directories and 0 images in &#39;/content/brain_tumor_split/validation_data&#39;.
There are 0 directories and 27 images in &#39;/content/brain_tumor_split/validation_data/yes&#39;.
There are 0 directories and 28 images in &#39;/content/brain_tumor_split/validation_data/no&#39;.
There are 2 directories and 0 images in &#39;/content/brain_tumor_split/train_data&#39;.
There are 0 directories and 124 images in &#39;/content/brain_tumor_split/train_data/yes&#39;.
There are 0 directories and 68 images in &#39;/content/brain_tumor_split/train_data/no&#39;.
There are 2 directories and 0 images in &#39;/content/brain_tumor_split/test_data&#39;.
There are 0 directories and 4 images in &#39;/content/brain_tumor_split/test_data/yes&#39;.
There are 0 directories and 2 images in &#39;/content/brain_tumor_split/test_data/no&#39;.
</code></pre>
  </div>
</div>
<section id="visualisasi-data" class="cell-markdown" id="ux9om_zcut4U">
  <h3>Visualisasi Data</h3>
</section>
<div
  class="cell-code"
  data-execution_count="42"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="aSSrR_gWuuOa"
  data-outputId="55f2e48c-74e5-4c30-b592-ccdec0217857"
>
  <div class="sourceCode" id="cb37">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>train_no_path <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/train_data/no&quot;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>val_no_path <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/validation_data/no&quot;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>test_no_path <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/test_data/no&quot;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>train_yes_path <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/train_data/yes&quot;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>val_yes_path <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/validation_data/yes&quot;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>test_yes_path <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/test_data/yes&quot;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>train_path <span class="op">=</span> [train_no_path, train_yes_path]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>val_path <span class="op">=</span> [val_no_path, val_yes_path]</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>test_path <span class="op">=</span> [test_no_path, test_yes_path]</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>Jumlah_train <span class="op">=</span> []</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> train_path:</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  count <span class="op">=</span> count_images_in_folder(x)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  Jumlah_train.append(count)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>Jumlah_val <span class="op">=</span> []</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> val_path:</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  count <span class="op">=</span> count_images_in_folder(x)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  Jumlah_val.append(count)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Jumlah_train)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Jumlah_val)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>[68, 124]
[28, 27]
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="45"
  data-colab='{"base_uri":"https://localhost:8080/","height":601}'
  id="UdHFNuyIvnjU"
  data-outputId="f68c4a0f-a630-4dde-ce0e-6ca584e2d073"
>
  <div class="sourceCode" id="cb39">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span>  <span class="co"># Lebar batang</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat plot menggunakan seaborn</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">&quot;whitegrid&quot;</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot untuk Jumlah_train</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>train_bar <span class="op">=</span> np.arange(<span class="bu">len</span>(label))</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>train_plot <span class="op">=</span> plt.bar(train_bar, Jumlah_train, width, label<span class="op">=</span><span class="st">&#39;Jumlah Train&#39;</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot untuk Jumlah_test</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>test_bar <span class="op">=</span> train_bar <span class="op">+</span> width</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>test_plot <span class="op">=</span> plt.bar(test_bar, Jumlah_val, width, label<span class="op">=</span><span class="st">&#39;Jumlah Validation&#39;</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Menambahkan label pada sumbu x dan sumbu y</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Kelas&#39;</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Jumlah Data&#39;</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Menambahkan label pada setiap batang</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label)):</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    plt.text(train_bar[i], Jumlah_train[i], <span class="bu">str</span>(Jumlah_train[i]), ha<span class="op">=</span><span class="st">&#39;center&#39;</span>)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    plt.text(test_bar[i], Jumlah_val[i], <span class="bu">str</span>(Jumlah_val[i]), ha<span class="op">=</span><span class="st">&#39;center&#39;</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Menambahkan judul dan legend</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Jumlah Data Training dan Testing per Kelas&#39;</span>)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Menandai posisi kelas pada sumbu x</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>plt.xticks(train_bar <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, label)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\69e04dbc385aaf89a01291f441961b5291ed1a1c.png' %}"
      />
    </p>
  </div>
</div>
<div class="cell-markdown" id="OuoAitL3w2j1">
  <p>Jumlah perbandingan train data dan validation data : 70% / 30%</p>
</div>
<section id="augmentasi-data" class="cell-markdown" id="u_wmDLsvhzt3">
  <h3>Augmentasi Data</h3>
</section>
<div
  class="cell-code"
  data-execution_count="46"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="nzHWBUeWhypY"
  data-outputId="33dc2332-eb14-4cf9-d2ab-f8cced0f8e8d"
>
  <div class="sourceCode" id="cb40">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup data inputs</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>IMAGE_SHAPE <span class="op">=</span> (<span class="dv">224</span>, <span class="dv">224</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>BATCH_SIZE <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>train_dir <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/train_data&quot;</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>test_dir <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/test_data&quot;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>validation_dir <span class="op">=</span> <span class="st">&quot;/content/brain_tumor_split/validation_data&quot;</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>train_datagen <span class="op">=</span> ImageDataGenerator(rescale<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="fl">255.</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>test_datagen <span class="op">=</span> ImageDataGenerator(rescale<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="fl">255.</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>validation_datagen <span class="op">=</span> ImageDataGenerator(rescale<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="fl">255.</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Training images:&quot;</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_datagen.flow_from_directory(train_dir,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>                                               target_size<span class="op">=</span>IMAGE_SHAPE,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>                                               batch_size<span class="op">=</span>BATCH_SIZE,</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>                                               class_mode<span class="op">=</span><span class="st">&quot;categorical&quot;</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Training images:&quot;</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> test_datagen.flow_from_directory(test_dir,</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>                                             target_size<span class="op">=</span>IMAGE_SHAPE,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>                                             batch_size<span class="op">=</span>BATCH_SIZE,</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>                                             class_mode<span class="op">=</span><span class="st">&quot;categorical&quot;</span>)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Testing images:&quot;</span>)</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>validation_data <span class="op">=</span> validation_datagen.flow_from_directory(validation_dir,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>                                              target_size<span class="op">=</span>IMAGE_SHAPE,</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>                                              batch_size<span class="op">=</span>BATCH_SIZE,</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>                                              class_mode<span class="op">=</span><span class="st">&quot;categorical&quot;</span>)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Training images:
Found 192 images belonging to 2 classes.
Training images:
Found 6 images belonging to 2 classes.
Testing images:
Found 55 images belonging to 2 classes.
</code></pre>
  </div>
</div>
<section id="modelling" class="cell-markdown" id="PIBq1NgWjqVR">
  <h2>Modelling</h2>
</section>
<section id="model-0" class="cell-markdown" id="otac6S-bkEqh">
  <h3>Model 0</h3>
</section>
<div
  class="cell-code"
  data-execution_count="47"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="7p_Hkjx9kKc8"
  data-outputId="b951f321-978d-4e2c-e14f-e9e835877408"
>
  <div class="sourceCode" id="cb42">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Input, Conv2D, MaxPool2D, Flatten, Dense, BatchNormalization, Dropout</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Model</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>inputs <span class="op">=</span> Input(shape<span class="op">=</span>(<span class="dv">224</span>, <span class="dv">224</span>, <span class="dv">3</span>))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> Conv2D(<span class="dv">16</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>)(inputs)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> Conv2D(<span class="dv">16</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>)(x)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> MaxPool2D()(x)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>)(inputs)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>)(x)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> MaxPool2D()(x)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> Flatten()(x)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> Dropout(<span class="fl">0.5</span>)(x)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>outputs <span class="op">=</span> Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">&#39;sigmoid&#39;</span>)(x)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>model_0 <span class="op">=</span> Model(inputs<span class="op">=</span>inputs, outputs<span class="op">=</span>outputs)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>model_0.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&quot;binary_crossentropy&quot;</span>,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                optimizer<span class="op">=</span>tf.keras.optimizers.Adam(),</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                metrics<span class="op">=</span>[<span class="st">&quot;accuracy&quot;</span>])</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>history_0 <span class="op">=</span> model_0.fit(train_data,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                        epochs<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># steps_per_epoch=len(train_data),</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>                        validation_data<span class="op">=</span>validation_data,</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># validation_steps=len(validation_data)</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>                        )</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Epoch 1/5
6/6 [==============================] - 14s 328ms/step - loss: 2.3345 - accuracy: 0.5000 - val_loss: 0.9272 - val_accuracy: 0.5000
Epoch 2/5
6/6 [==============================] - 1s 180ms/step - loss: 0.7363 - accuracy: 0.5000 - val_loss: 0.6932 - val_accuracy: 0.5000
Epoch 3/5
6/6 [==============================] - 1s 223ms/step - loss: 0.6932 - accuracy: 0.5000 - val_loss: 0.6932 - val_accuracy: 0.5000
Epoch 4/5
6/6 [==============================] - 1s 221ms/step - loss: 0.6932 - accuracy: 0.5000 - val_loss: 0.6932 - val_accuracy: 0.5000
Epoch 5/5
6/6 [==============================] - 1s 169ms/step - loss: 0.6932 - accuracy: 0.5000 - val_loss: 0.6932 - val_accuracy: 0.5000
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="72"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="gEyIwyW8zS7g"
  data-outputId="36c81a7b-e57a-400f-cef1-ecd0fbd141ab"
>
  <div class="sourceCode" id="cb44">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>model_0.summary()</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Model: &quot;model&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 224, 224, 3)]     0         
                                                                 
 conv2d_2 (Conv2D)           (None, 222, 222, 32)      896       
                                                                 
 conv2d_3 (Conv2D)           (None, 220, 220, 32)      9248      
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 110, 110, 32)     0         
 2D)                                                             
                                                                 
 flatten (Flatten)           (None, 387200)            0         
                                                                 
 dropout (Dropout)           (None, 387200)            0         
                                                                 
 dense (Dense)               (None, 1)                 387201    
                                                                 
=================================================================
Total params: 397,345
Trainable params: 397,345
Non-trainable params: 0
_________________________________________________________________
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="48"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="Vls4EJuPskLu"
  data-outputId="92647ec4-7e4d-444c-f4ad-b43440560615"
>
  <div class="sourceCode" id="cb46">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>baseModel_result <span class="op">=</span> model_0.evaluate(test_data)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>1/1 [==============================] - 0s 211ms/step - loss: 0.6932 - accuracy: 0.5000
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="49"
  data-colab='{"base_uri":"https://localhost:8080/","height":943}'
  id="2ICXZCK-xQ9Z"
  data-outputId="cc1e8d6d-c14b-49f6-8429-25da617454c2"
>
  <div class="sourceCode" id="cb48">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out the model&#39;s loss curves on the 10 classes of data (note: this function comes from above in the notebook)</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>plot_loss_curves(history_0)</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\ff35a158a3064862239afeb444762898a99826fe.png' %}"
      />
    </p>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\187bdead8e0be09565a26eec2f92cfe83e780dbb.png' %}"
      />
    </p>
  </div>
</div>
<section id="model-1-transfer-learning" class="cell-markdown" id="Hu60t3HbmBET">
  <h3>Model 1 (Transfer Learning)</h3>
</section>
<div class="cell-code" data-execution_count="50" id="1-k_tVz6l_kM">
  <div class="sourceCode" id="cb49">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow_hub <span class="im">as</span> hub</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span></code></pre>
  </div>
</div>
<div class="cell-code" data-execution_count="51" id="lw96_zQdm7o0">
  <div class="sourceCode" id="cb50">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_model(model_url, num_classes<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">&quot;&quot;&quot;Takes a TensorFlow Hub URL and creates a Keras Sequential model with it.</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Args:</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">    model_url (str): A TensorFlow Hub feature extraction URL.</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co">    num_classes (int): Number of output neurons in output layer,</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co">      should be equal to number of target classes, default 10.</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns:</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co">    An uncompiled Keras Sequential model with model_url as feature</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co">    extractor layer and Dense output layer with num_classes outputs.</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co">  &quot;&quot;&quot;</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Download the pretrained model and save it as a Keras layer</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  feature_extractor_layer <span class="op">=</span> hub.KerasLayer(model_url,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>                                           trainable<span class="op">=</span><span class="va">False</span>, <span class="co"># freeze the underlying patterns</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                                           name<span class="op">=</span><span class="st">&#39;feature_extraction_layer&#39;</span>,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>                                           input_shape<span class="op">=</span>IMAGE_SHAPE<span class="op">+</span>(<span class="dv">3</span>,)) <span class="co"># define the input image shape</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create our own model</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  model <span class="op">=</span> tf.keras.Sequential([</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    feature_extractor_layer, <span class="co"># use the feature extraction layer as the base</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    layers.Dense(num_classes, activation<span class="op">=</span><span class="st">&#39;softmax&#39;</span>, name<span class="op">=</span><span class="st">&#39;output_layer&#39;</span>) <span class="co"># create our own output layer</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  ])</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> model</span></code></pre>
  </div>
</div>
<div class="cell-code" data-execution_count="52" id="nE-CjX6Gm4ce">
  <div class="sourceCode" id="cb51">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resnet 50 V2 feature vector</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>resnet_url <span class="op">=</span> <span class="st">&quot;https://tfhub.dev/google/imagenet/resnet_v2_50/feature_vector/4&quot;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Original: EfficientNetB0 feature vector (version 1)</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>efficientnet_url <span class="op">=</span> <span class="st">&quot;https://tfhub.dev/tensorflow/efficientnet/b0/feature-vector/1&quot;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # New: EfficientNetB0 feature vector (version 2)</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># efficientnet_url = &quot;https://tfhub.dev/google/imagenet/efficientnet_v2_imagenet1k_b0/feature_vector/2&quot;</span></span></code></pre>
  </div>
</div>
<section id="resnet" class="cell-markdown" id="pK2thTgbn2aO">
  <h4>Resnet</h4>
</section>
<div class="cell-code" data-execution_count="53" id="a5_sC56nnLsu">
  <div class="sourceCode" id="cb52">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create model</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>resnet_model <span class="op">=</span> create_model(resnet_url, num_classes<span class="op">=</span>train_data.num_classes)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>resnet_model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&#39;categorical_crossentropy&#39;</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                     optimizer<span class="op">=</span>tf.keras.optimizers.Adam(),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                     metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span></code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="70"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="fPVf-0G8zKiC"
  data-outputId="b4a08bbb-b7cc-4e57-8937-fcc8afd36336"
>
  <div class="sourceCode" id="cb53">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>resnet_model.summary()</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Model: &quot;sequential&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 feature_extraction_layer (K  (None, 2048)             23564800  
 erasLayer)                                                      
                                                                 
 output_layer (Dense)        (None, 2)                 4098      
                                                                 
=================================================================
Total params: 23,568,898
Trainable params: 4,098
Non-trainable params: 23,564,800
_________________________________________________________________
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="54"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="FYGcliVsna9g"
  data-outputId="a887509a-31d1-4fc4-9437-dd59df2be16c"
>
  <div class="sourceCode" id="cb55">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> tf.keras.callbacks.EarlyStopping(min_delta<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                          patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                          verbose<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                          restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>resnet_history <span class="op">=</span> resnet_model.fit(train_data,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                                  epochs<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                                  steps_per_epoch<span class="op">=</span><span class="bu">len</span>(train_data),</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                                  validation_data<span class="op">=</span>validation_data,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                                  validation_steps<span class="op">=</span><span class="bu">len</span>(validation_data),</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                                  callbacks<span class="op">=</span>[early_stopping]</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                                  )</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Epoch 1/50
6/6 [==============================] - 9s 605ms/step - loss: 1.1946 - accuracy: 0.4896 - val_loss: 0.9250 - val_accuracy: 0.5091
Epoch 2/50
6/6 [==============================] - 1s 211ms/step - loss: 0.8157 - accuracy: 0.5677 - val_loss: 0.7469 - val_accuracy: 0.5818
Epoch 3/50
6/6 [==============================] - 1s 209ms/step - loss: 0.6197 - accuracy: 0.6875 - val_loss: 0.6669 - val_accuracy: 0.6545
Epoch 4/50
6/6 [==============================] - 1s 227ms/step - loss: 0.4439 - accuracy: 0.7969 - val_loss: 0.5338 - val_accuracy: 0.7455
Epoch 5/50
6/6 [==============================] - 1s 215ms/step - loss: 0.3928 - accuracy: 0.8438 - val_loss: 0.4949 - val_accuracy: 0.7636
Epoch 6/50
6/6 [==============================] - 1s 223ms/step - loss: 0.3208 - accuracy: 0.8542 - val_loss: 0.4827 - val_accuracy: 0.7818
Epoch 7/50
6/6 [==============================] - 1s 215ms/step - loss: 0.2861 - accuracy: 0.8906 - val_loss: 0.4357 - val_accuracy: 0.8000
Epoch 8/50
6/6 [==============================] - 1s 212ms/step - loss: 0.2476 - accuracy: 0.9167 - val_loss: 0.4080 - val_accuracy: 0.8182
Epoch 9/50
6/6 [==============================] - 1s 222ms/step - loss: 0.2238 - accuracy: 0.9323 - val_loss: 0.3912 - val_accuracy: 0.8364
Epoch 10/50
6/6 [==============================] - 1s 220ms/step - loss: 0.2042 - accuracy: 0.9427 - val_loss: 0.3798 - val_accuracy: 0.8727
Epoch 11/50
6/6 [==============================] - 2s 339ms/step - loss: 0.1860 - accuracy: 0.9479 - val_loss: 0.3677 - val_accuracy: 0.8364
Epoch 12/50
6/6 [==============================] - 2s 371ms/step - loss: 0.1713 - accuracy: 0.9583 - val_loss: 0.3578 - val_accuracy: 0.8727
Epoch 13/50
6/6 [==============================] - 2s 259ms/step - loss: 0.1557 - accuracy: 0.9635 - val_loss: 0.3536 - val_accuracy: 0.8545
Epoch 14/50
6/6 [==============================] - 1s 233ms/step - loss: 0.1446 - accuracy: 0.9688 - val_loss: 0.3514 - val_accuracy: 0.8727
Epoch 15/50
6/6 [==============================] - 2s 274ms/step - loss: 0.1342 - accuracy: 0.9740 - val_loss: 0.3456 - val_accuracy: 0.8545
Epoch 16/50
6/6 [==============================] - 1s 222ms/step - loss: 0.1250 - accuracy: 0.9792 - val_loss: 0.3443 - val_accuracy: 0.8545
Epoch 17/50
6/6 [==============================] - 1s 226ms/step - loss: 0.1158 - accuracy: 0.9844 - val_loss: 0.3413 - val_accuracy: 0.8545
Epoch 18/50
6/6 [==============================] - 1s 198ms/step - loss: 0.1083 - accuracy: 0.9844 - val_loss: 0.3416 - val_accuracy: 0.8545
Epoch 19/50
6/6 [==============================] - 1s 217ms/step - loss: 0.1007 - accuracy: 0.9896 - val_loss: 0.3400 - val_accuracy: 0.8545
Epoch 20/50
6/6 [==============================] - 2s 279ms/step - loss: 0.0953 - accuracy: 0.9896 - val_loss: 0.3382 - val_accuracy: 0.8545
Epoch 21/50
6/6 [==============================] - 1s 248ms/step - loss: 0.0892 - accuracy: 0.9896 - val_loss: 0.3370 - val_accuracy: 0.8909
Epoch 22/50
6/6 [==============================] - 1s 216ms/step - loss: 0.0840 - accuracy: 0.9948 - val_loss: 0.3362 - val_accuracy: 0.8545
Epoch 23/50
6/6 [==============================] - 1s 197ms/step - loss: 0.0797 - accuracy: 0.9948 - val_loss: 0.3369 - val_accuracy: 0.8545
Epoch 24/50
6/6 [==============================] - 1s 217ms/step - loss: 0.0751 - accuracy: 1.0000 - val_loss: 0.3332 - val_accuracy: 0.8909
Epoch 25/50
6/6 [==============================] - 1s 231ms/step - loss: 0.0710 - accuracy: 1.0000 - val_loss: 0.3328 - val_accuracy: 0.8909
Epoch 26/50
6/6 [==============================] - 1s 192ms/step - loss: 0.0681 - accuracy: 1.0000 - val_loss: 0.3343 - val_accuracy: 0.8909
Epoch 27/50
6/6 [==============================] - 2s 272ms/step - loss: 0.0641 - accuracy: 1.0000 - val_loss: 0.3373 - val_accuracy: 0.8727
Epoch 28/50
6/6 [==============================] - ETA: 0s - loss: 0.0614 - accuracy: 1.0000Restoring model weights from the end of the best epoch: 25.
6/6 [==============================] - 2s 335ms/step - loss: 0.0614 - accuracy: 1.0000 - val_loss: 0.3367 - val_accuracy: 0.8727
Epoch 28: early stopping
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="55"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="RNhJKv_Ysx4B"
  data-outputId="b1953885-7829-4dde-8e76-0382bf71f01b"
>
  <div class="sourceCode" id="cb57">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>resnet_result <span class="op">=</span> resnet_model.evaluate(validation_data)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>2/2 [==============================] - 0s 109ms/step - loss: 0.3328 - accuracy: 0.8909
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="56"
  data-colab='{"base_uri":"https://localhost:8080/","height":943}'
  id="PSr_eh8SxUhn"
  data-outputId="8f41676f-fc3a-4470-e8ec-ab51313ee35e"
>
  <div class="sourceCode" id="cb59">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out the model&#39;s loss curves on the 10 classes of data (note: this function comes from above in the notebook)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>plot_loss_curves(resnet_history)</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\fd73c599bad2dfd356dea7a700635a338ddd5cfe.png' %}"
      />
    </p>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\5c5f8379d028bfc9d05d8d6f82646e86853479ca.png' %}"
      />
    </p>
  </div>
</div>
<section id="efficientnet" class="cell-markdown" id="lZnj6DVrn7rC">
  <h4>efficientnet</h4>
</section>
<div class="cell-code" data-execution_count="57" id="WyMrD8FLoCzw">
  <div class="sourceCode" id="cb60">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create model</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>efficientnet_model <span class="op">=</span> create_model(efficientnet_url, num_classes<span class="op">=</span>train_data.num_classes)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>efficientnet_model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&#39;categorical_crossentropy&#39;</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                     optimizer<span class="op">=</span>tf.keras.optimizers.Adam(),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                     metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span></code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="71"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="YFPArBfWzO6I"
  data-outputId="45fcdf1f-f499-4fa6-972a-eefd8b6760e8"
>
  <div class="sourceCode" id="cb61">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>efficientnet_model.summary()</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Model: &quot;sequential_1&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 feature_extraction_layer (K  (None, 1280)             4049564   
 erasLayer)                                                      
                                                                 
 output_layer (Dense)        (None, 2)                 2562      
                                                                 
=================================================================
Total params: 4,052,126
Trainable params: 2,562
Non-trainable params: 4,049,564
_________________________________________________________________
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="58"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="2Z7tbIV7oIpV"
  data-outputId="d1828122-4c85-4d34-afa9-6b94dbbb8f2b"
>
  <div class="sourceCode" id="cb63">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> tf.keras.callbacks.EarlyStopping(min_delta<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                          patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                          verbose<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                          restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>efficientnet_history <span class="op">=</span> efficientnet_model.fit(train_data,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                                  epochs<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                                  steps_per_epoch<span class="op">=</span><span class="bu">len</span>(train_data),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                                  validation_data<span class="op">=</span>validation_data,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                                  validation_steps<span class="op">=</span><span class="bu">len</span>(validation_data),</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>                                  callbacks<span class="op">=</span>[early_stopping]</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                                  )</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Epoch 1/50
6/6 [==============================] - 14s 724ms/step - loss: 0.6062 - accuracy: 0.6771 - val_loss: 0.6505 - val_accuracy: 0.6182
Epoch 2/50
6/6 [==============================] - 1s 195ms/step - loss: 0.4925 - accuracy: 0.8125 - val_loss: 0.5584 - val_accuracy: 0.6909
Epoch 3/50
6/6 [==============================] - 1s 198ms/step - loss: 0.4214 - accuracy: 0.8177 - val_loss: 0.5088 - val_accuracy: 0.7636
Epoch 4/50
6/6 [==============================] - 1s 194ms/step - loss: 0.3743 - accuracy: 0.8438 - val_loss: 0.4687 - val_accuracy: 0.8182
Epoch 5/50
6/6 [==============================] - 1s 186ms/step - loss: 0.3414 - accuracy: 0.8594 - val_loss: 0.4538 - val_accuracy: 0.8182
Epoch 6/50
6/6 [==============================] - 1s 197ms/step - loss: 0.3103 - accuracy: 0.8854 - val_loss: 0.4216 - val_accuracy: 0.8545
Epoch 7/50
6/6 [==============================] - 1s 196ms/step - loss: 0.2860 - accuracy: 0.9010 - val_loss: 0.4053 - val_accuracy: 0.8364
Epoch 8/50
6/6 [==============================] - 1s 200ms/step - loss: 0.2666 - accuracy: 0.9219 - val_loss: 0.3941 - val_accuracy: 0.8364
Epoch 9/50
6/6 [==============================] - 1s 199ms/step - loss: 0.2507 - accuracy: 0.9167 - val_loss: 0.3875 - val_accuracy: 0.8545
Epoch 10/50
6/6 [==============================] - 1s 243ms/step - loss: 0.2380 - accuracy: 0.9167 - val_loss: 0.3706 - val_accuracy: 0.8182
Epoch 11/50
6/6 [==============================] - 1s 255ms/step - loss: 0.2231 - accuracy: 0.9271 - val_loss: 0.3717 - val_accuracy: 0.8364
Epoch 12/50
6/6 [==============================] - 1s 196ms/step - loss: 0.2146 - accuracy: 0.9323 - val_loss: 0.3700 - val_accuracy: 0.8364
Epoch 13/50
6/6 [==============================] - 1s 200ms/step - loss: 0.2023 - accuracy: 0.9427 - val_loss: 0.3581 - val_accuracy: 0.8545
Epoch 14/50
6/6 [==============================] - 1s 199ms/step - loss: 0.1947 - accuracy: 0.9427 - val_loss: 0.3519 - val_accuracy: 0.8545
Epoch 15/50
6/6 [==============================] - 2s 284ms/step - loss: 0.1857 - accuracy: 0.9427 - val_loss: 0.3575 - val_accuracy: 0.8545
Epoch 16/50
6/6 [==============================] - 1s 177ms/step - loss: 0.1789 - accuracy: 0.9531 - val_loss: 0.3532 - val_accuracy: 0.8545
Epoch 17/50
6/6 [==============================] - 1s 197ms/step - loss: 0.1736 - accuracy: 0.9479 - val_loss: 0.3414 - val_accuracy: 0.8364
Epoch 18/50
6/6 [==============================] - 1s 224ms/step - loss: 0.1653 - accuracy: 0.9479 - val_loss: 0.3459 - val_accuracy: 0.8545
Epoch 19/50
6/6 [==============================] - 1s 178ms/step - loss: 0.1589 - accuracy: 0.9583 - val_loss: 0.3475 - val_accuracy: 0.8545
Epoch 20/50
6/6 [==============================] - 2s 312ms/step - loss: 0.1551 - accuracy: 0.9583 - val_loss: 0.3383 - val_accuracy: 0.8364
Epoch 21/50
6/6 [==============================] - 2s 283ms/step - loss: 0.1479 - accuracy: 0.9635 - val_loss: 0.3425 - val_accuracy: 0.8364
Epoch 22/50
6/6 [==============================] - 1s 177ms/step - loss: 0.1439 - accuracy: 0.9583 - val_loss: 0.3419 - val_accuracy: 0.8364
Epoch 23/50
6/6 [==============================] - 1s 189ms/step - loss: 0.1395 - accuracy: 0.9635 - val_loss: 0.3358 - val_accuracy: 0.8364
Epoch 24/50
6/6 [==============================] - 1s 180ms/step - loss: 0.1340 - accuracy: 0.9635 - val_loss: 0.3391 - val_accuracy: 0.8364
Epoch 25/50
6/6 [==============================] - 1s 172ms/step - loss: 0.1304 - accuracy: 0.9688 - val_loss: 0.3398 - val_accuracy: 0.8545
Epoch 26/50
6/6 [==============================] - 1s 237ms/step - loss: 0.1264 - accuracy: 0.9740 - val_loss: 0.3333 - val_accuracy: 0.8364
Epoch 27/50
6/6 [==============================] - 1s 184ms/step - loss: 0.1224 - accuracy: 0.9792 - val_loss: 0.3353 - val_accuracy: 0.8545
Epoch 28/50
6/6 [==============================] - 1s 178ms/step - loss: 0.1190 - accuracy: 0.9844 - val_loss: 0.3355 - val_accuracy: 0.8545
Epoch 29/50
6/6 [==============================] - ETA: 0s - loss: 0.1154 - accuracy: 0.9844Restoring model weights from the end of the best epoch: 26.
6/6 [==============================] - 1s 222ms/step - loss: 0.1154 - accuracy: 0.9844 - val_loss: 0.3355 - val_accuracy: 0.8545
Epoch 29: early stopping
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="59"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="BS2CRk5Fs8pS"
  data-outputId="9b7746df-da89-428f-965c-e88d88df59af"
>
  <div class="sourceCode" id="cb65">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>efficientnet_result <span class="op">=</span> efficientnet_model.evaluate(validation_data)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>2/2 [==============================] - 0s 101ms/step - loss: 0.3333 - accuracy: 0.8364
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="60"
  data-colab='{"base_uri":"https://localhost:8080/","height":943}'
  id="7NCJ2owVxaj9"
  data-outputId="a20f95f3-bc82-4f08-e1a5-631a83c0949e"
>
  <div class="sourceCode" id="cb67">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out the model&#39;s loss curves on the 10 classes of data (note: this function comes from above in the notebook)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>plot_loss_curves(efficientnet_history)</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\6dea088eaa2e1fdc949c96476464eaf7ce641e83.png' %}"
      />
    </p>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\f766737155b7eefe69e565c1b827188500132789.png' %}"
      />
    </p>
  </div>
</div>
<section id="evaluation" class="cell-markdown" id="ijx09Ikqwf6i">
  <h2>Evaluation</h2>
</section>
<div
  class="cell-code"
  data-execution_count="61"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="7rF5uM9rttC_"
  data-outputId="5c343cac-59dd-4539-ce06-f0a7bf113483"
>
  <div class="sourceCode" id="cb68">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pathlib</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>data_dir <span class="op">=</span> pathlib.Path(<span class="st">&quot;/content/brain_tumor_split/train_data&quot;</span>) <span class="co"># turn our training path into a Python path</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># class_names = np.array([item.name for item in data_dir.glob(&#39;*&#39;)]) # created a list of class_names from the subdirectories</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>class_names <span class="op">=</span> np.array([item.name <span class="cf">for</span> item <span class="kw">in</span> <span class="bu">sorted</span>(data_dir.glob(<span class="st">&#39;*&#39;</span>))]) <span class="co"># created a list of class_names from the subdirectories</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>class_names</span></code></pre>
  </div>
  <div class="output execute_result" data-execution_count="61">
    <pre><code>array([&#39;no&#39;, &#39;yes&#39;], dtype=&#39;&lt;U3&#39;)</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="62"
  data-colab='{"base_uri":"https://localhost:8080/"}'
  id="RxbJhrs0t_CY"
  data-outputId="96941b6b-ca44-4231-82d3-7022f9559944"
>
  <div class="sourceCode" id="cb70">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Akurasi Base Model = </span><span class="sc">{</span>baseModel_result[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Akurasi Resnet = </span><span class="sc">{</span><span class="bu">round</span>(resnet_result[<span class="dv">1</span>],<span class="dv">2</span>)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Akurasi Efficientnet =</span><span class="sc">{</span><span class="bu">round</span>(efficientnet_result[<span class="dv">1</span>],<span class="dv">2</span>)<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>Akurasi Base Model = 0.5
Akurasi Resnet = 0.89
Akurasi Efficientnet =0.84
</code></pre>
  </div>
</div>
<div
  class="cell-code"
  data-execution_count="73"
  data-colab='{"base_uri":"https://localhost:8080/","height":573}'
  id="BpiH3g8GxmEL"
  data-outputId="813f3499-b67d-4000-f763-9fb680dfca1b"
>
  <div class="sourceCode" id="cb72">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>akurasi <span class="op">=</span> [<span class="bu">round</span>(baseModel_result[<span class="dv">1</span>],<span class="dv">4</span>), <span class="bu">round</span>(resnet_result[<span class="dv">1</span>],<span class="dv">4</span>), <span class="bu">round</span>(efficientnet_result[<span class="dv">1</span>],<span class="dv">4</span>)]</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> [<span class="st">&quot;Base Model&quot;</span>, <span class="st">&quot;Resnet&quot;</span>, <span class="st">&quot;Efficientnet&quot;</span>]</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat plot menggunakan seaborn</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">&quot;whitegrid&quot;</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>model, y<span class="op">=</span>akurasi)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Akurasi Tiap Model&#39;</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Model&#39;</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Akurasi&#39;</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Menambahkan keterangan nilai akurasi pada setiap batang</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(akurasi)):</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    plt.text(i, akurasi[i] <span class="op">+</span> <span class="fl">0.01</span>, <span class="bu">str</span>(akurasi[i]), ha<span class="op">=</span><span class="st">&#39;center&#39;</span>)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\9ae3c75cd32237c0a50f27c3d75645726d43b432.png' %}"
      />
    </p>
  </div>
</div>
<div class="cell-markdown" id="xIp5xHJ0yHjj">
  <p>Restnet Memiliki Akurasi Tertinggi dibandingkan ketiga model</p>
</div>
<section id="test-predict-new-image" class="cell-markdown" id="i4YJHhxly5Mf">
  <h2>Test Predict New Image</h2>
</section>
<div
  class="cell-code"
  data-execution_count="69"
  data-colab='{"base_uri":"https://localhost:8080/","height":445}'
  id="-onakxVltXB9"
  data-outputId="bae8cdf0-0e33-44f9-8a87-c13face01858"
>
  <div class="sourceCode" id="cb73">
    <div class="nomor-samping-cell">
      <h4>[1]</h4>
    </div>
    <pre
      class="sourceCode-python"
    ><code class="sourceCode-python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>pred_and_plot(model<span class="op">=</span>resnet_model,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>              filename<span class="op">=</span><span class="st">&quot;/content/brain_tumor_split/test_data/yes/Y9_cropped_0.jpg&quot;</span>,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>              class_names<span class="op">=</span>class_names)</span></code></pre>
  </div>
  <div class="output stream stdout">
    <pre><code>1/1 [==============================] - 0s 25ms/step
</code></pre>
  </div>
  <div class="output display_data">
    <p>
      <img
        src="{% static 'img\tumor_new\a0e38b24a2984b29a7208892716f0a3c8820b9a4.png' %}"
      />
    </p>
  </div>
</div>
<div class="cell-markdown" id="0BDFEm73y_O3">
  <p>Model dapat memprediksi dengan benar menggunakan gambar baru</p>
</div>
{% endblock contents %}
